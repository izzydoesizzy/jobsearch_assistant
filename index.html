<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Job Search Prompts Library</title>
    <link rel="stylesheet" href="styles.css" />
    <script src="https://cdn.jsdelivr.net/npm/pdfjs-dist@4.7.76/build/pdf.min.js"></script>
    <script src="https://unpkg.com/mammoth@1.8.0/mammoth.browser.min.js"></script>
  </head>
  <body>
    <main class="app-layout">
      <aside class="prompt-sidebar">
        <div class="sidebar-head">
          <h2>Prompts Library</h2>
          <p id="selectedCount">0 of 0 selected</p>
        </div>
        <input id="promptSearch" type="search" placeholder="Search prompts" />

        <section class="prompt-controls" aria-label="Prompt category controls">
          <div id="categoryChips" class="category-chips"></div>
          <div class="action-row">
            <button id="selectCategory" class="btn btn-ghost" type="button">Select all in category</button>
            <button id="clearCategory" class="btn btn-ghost" type="button">Clear category</button>
          </div>
          <div class="action-row">
            <button id="selectVisible" class="btn btn-ghost" type="button">Select all visible</button>
            <button id="clearVisible" class="btn btn-ghost" type="button">Clear visible</button>
          </div>
        </section>

        <div id="promptChecklist" class="prompt-checklist"></div>
        <button id="generateDoc" class="btn btn-primary">Generate Document</button>
      </aside>

      <section class="main-panel">
        <header>
          <h1>Client Document Generator</h1>
          <p>Upload context files, choose prompts, and generate a markdown output.</p>
        </header>

        <section class="card api-card">
          <h3>OpenAI Configuration</h3>
          <label>
            API Key
            <input id="apiKey" type="password" placeholder="sk-..." />
          </label>
          <p><strong>Model:</strong> <span id="modelName">gpt-5.2</span> (fixed)</p>
          <small>Your key is used only in-browser and stored in localStorage on this device.</small>
        </section>

        <section class="card">
          <h3>Context Files</h3>
          <p>Add at least a resume. Supported extraction: .txt/.md/.pdf/.docx</p>
          <div class="upload-grid">
            <label class="upload-item">Resume (required)
              <input type="file" id="resumeFile" accept=".txt,.md,.pdf,.doc,.docx" />
              <div class="source-controls">
                <button type="button" class="toggle-paste-btn" data-key="resume" id="resumeTogglePaste">Paste text instead</button>
                <select id="resumeMode" class="source-mode-select" aria-label="Resume source mode">
                  <option value="auto">Auto-select source</option>
                  <option value="file">Use file</option>
                  <option value="pasted">Use pasted text</option>
                </select>
              </div>
              <textarea id="resumePaste" class="paste-textarea" placeholder="Paste resume text here..."></textarea>
              <span id="resumeStatus">No file selected</span>
            </label>
            <label class="upload-item">LinkedIn Profile (optional)
              <input type="file" id="linkedinFile" accept=".txt,.md,.pdf,.doc,.docx" />
              <div class="source-controls">
                <button type="button" class="toggle-paste-btn" data-key="linkedin" id="linkedinTogglePaste">Paste text instead</button>
                <select id="linkedinMode" class="source-mode-select" aria-label="LinkedIn source mode">
                  <option value="auto">Auto-select source</option>
                  <option value="file">Use file</option>
                  <option value="pasted">Use pasted text</option>
                </select>
              </div>
              <textarea id="linkedinPaste" class="paste-textarea" placeholder="Paste LinkedIn profile text here..."></textarea>
              <span id="linkedinStatus">No file selected</span>
            </label>
            <label class="upload-item">Voice Transcript (optional)
              <input type="file" id="voiceFile" accept=".txt,.md,.pdf,.doc,.docx" />
              <div class="source-controls">
                <button type="button" class="toggle-paste-btn" data-key="voice" id="voiceTogglePaste">Paste text instead</button>
                <select id="voiceMode" class="source-mode-select" aria-label="Voice source mode">
                  <option value="auto">Auto-select source</option>
                  <option value="file">Use file</option>
                  <option value="pasted">Use pasted text</option>
                </select>
              </div>
              <textarea id="voicePaste" class="paste-textarea" placeholder="Paste voice transcript text here..."></textarea>
              <span id="voiceStatus">No file selected</span>
            </label>
            <label class="upload-item">Job Posting (optional)
              <input type="file" id="jobFile" accept=".txt,.md,.pdf,.doc,.docx" />
              <div class="source-controls">
                <button type="button" class="toggle-paste-btn" data-key="job" id="jobTogglePaste">Paste text instead</button>
                <select id="jobMode" class="source-mode-select" aria-label="Job source mode">
                  <option value="auto">Auto-select source</option>
                  <option value="file">Use file</option>
                  <option value="pasted">Use pasted text</option>
                </select>
              </div>
              <textarea id="jobPaste" class="paste-textarea" placeholder="Paste job posting text here..."></textarea>
              <span id="jobStatus">No file selected</span>
            </label>
          </div>
        </section>

        <section class="card info-box">
          <h3>Getting Started</h3>
          <ol>
            <li>Add context files (at minimum, add a resume)</li>
            <li>Select prompts from the left sidebar</li>
            <li>Click "Generate Document" to process</li>
            <li>Download your comprehensive analysis markdown</li>
          </ol>
        </section>

        <section class="card">
          <div class="output-head">
            <h3>Generated Markdown</h3>
            <button id="downloadMd" class="btn" disabled>Download .md</button>
          </div>
          <pre id="markdownOutput">No output generated yet.</pre>
        </section>
      </section>
    </main>

    <script src="data.js"></script>
    <script src="config.js"></script>
    <script src="app.js"></script>
  </body>
</html>
